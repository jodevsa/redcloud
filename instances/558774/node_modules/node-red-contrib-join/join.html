<script type="text/javascript">
    RED.nodes.registerType('join',{
        category: 'function',
        color: '#3FADB5',
        defaults: {
            name: {value:""},
			trigger: {value:""},
			topic: {value:""},
			overwrite: {value: false}
        },
        inputs:1,
        outputs:1,
        icon: "inject.png",
        label: function() {
            return this.name||"join";
        }
    });
</script>

<script type="text/x-red" data-template-name="join">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
	</div>
	<div class="form-row">
		<label for="node-input-trigger"><i class="icon-tag"></i> Trigger-topic</label>
        <input type="text" id="node-input-trigger" placeholder="trigger">
    </div>
	<div class="form-row">
		<label for="node-input-topic"><i class="icon-tag"></i> New Topic</label>
        <input type="text" id="node-input-topic" placeholder="topic">
    </div>
	 <div class="form-tips">
        Overwrite last object if the same node sent more than one object?
    </div>
	 <div class="form-row" id="node-overwrite">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-overwrite" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-overwrite" style="width: 70%;" >Overwrite</label>
    </div>
	
</script>

<script type="text/x-red" data-help-name="join">
    <p>This node joins two or more messages together.</p></br>
	
	<p> Messages from all input nodes are joined and put into the new payload. Since the messages might not arrive on the same time, there can be defined one input node as trigger. 
	The input node that triggers must be defined by its topic. 
	If messages arrive very asynchronously it could happen that one node sends multiple inputs in the time interval where the triggering node sends just once. 
	In such a case you can choose if you want to overwrite the multiple input messages (for every node) or just add them.
	</br>
	The new msg would look for example like this for 3 input nodes:
	</br>
	{ "payload": { "joinedMsgs": [ { "topic": "abc", "payload": "abc string", "_msgid": "e677e6b5.2a7738" }, { "topic": "def", "payload": "def string", "_msgid": "94a9460.f28acb8" }, { "topic": "trigger", "payload": "trigger string", "_msgid": "b063ac1.29ddb5" } ] }, "topic": "joined topic", "_msgid": "4e340eed.18b2b" }</p>
	
	
</script>